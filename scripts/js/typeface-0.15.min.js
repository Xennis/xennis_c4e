/*****************************************************************

typeface.js, version 0.15 | typefacejs.neocracy.org

Copyright (c) 2008 - 2009, David Chester davidchester@gmx.net 

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*****************************************************************/
(function(){var l={faces:{},loadFace:function(a){var c=a.familyName.toLowerCase();this.faces[c]||(this.faces[c]={});this.faces[c][a.cssFontWeight]||(this.faces[c][a.cssFontWeight]={});(this.faces[c][a.cssFontWeight][a.cssFontStyle]=a).loaded=!0},log:function(a){this.quiet||(a="typeface.js: "+a,this.customLogFn?this.customLogFn(a):window.console&&window.console.log&&window.console.log(a))},pixelsFromPoints:function(a,c,b,d){a=b*parseInt(c.fontSize)*72/(a.resolution*100);d=="horizontal"&&c.fontStretchPercent&&
(a*=c.fontStretchPercent);return a},pointsFromPixels:function(a,c,b,d){a=b*a.resolution/(parseInt(c.fontSize)*72/100);d=="horizontal"&&c.fontStretchPrecent&&(a*=c.fontStretchPercent);return a},cssFontWeightMap:{normal:"normal",bold:"bold",400:"normal",700:"bold"},cssFontStretchMap:{"ultra-condensed":0.55,"extra-condensed":0.77,condensed:0.85,"semi-condensed":0.93,normal:1,"semi-expanded":1.07,expanded:1.15,"extra-expanded":1.23,"ultra-expanded":1.45,"default":1},fallbackCharacter:".",configure:function(a){for(var c=
["customLogFn","customClassNameRegex","customTypefaceElementsList","quiet","verbose","disableSelection"],b=0;b<c.length;b++){var d=c[b];if(a[d])if(d=="customLogFn")if(typeof a[d]!="function")throw"customLogFn is not a function";else this.customLogFn=a.customLogFn;else this[d]=a[d]}},getTextExtents:function(a,c,b){for(var d=0,e,g=b.length,f=0;f<g;f++){var h=a.glyphs[b.charAt(f)]?a.glyphs[b.charAt(f)]:a.glyphs[this.fallbackCharacter],i=this.pointsFromPixels(a,c,c.letterSpacing);d+=f+1==g?Math.max(h.x_max,
h.ha):h.ha;d+=i;e+=h.ha+i}return{x:d,y:0,ha:e}},pixelsFromCssAmount:function(a,c,b){var d=void 0;if(a=="normal")return c;else if(d=a.match(/([\-\d+\.]+)px/))return d[1];else{d=b.style.left;var e=b.runtimeStyle.left;b.runtimeStyle.left=b.currentStyle.left;b.style.left=a.match(/\d(px|pt)$/)?a||0:"1em";a=b.style.pixelLeft;b.style.left=d;b.runtimeStyle.left=e;return a||c}},capitalizeText:function(a){return a.replace(/(^|\s)[a-z]/g,function(a){return a.toUpperCase()})},getElementStyle:function(a){if(window.getComputedStyle)return window.getComputedStyle(a,
"");else if(a.currentStyle)return a.currentStyle},getRenderedText:function(a){var c=this.getElementStyle(a.parentNode),b=a.parentNode.getAttribute("style");if(b&&typeof b=="object")b=b.cssText;if(b){var d=b.split(/\s*\;\s*/),e={};for(b=0;b<d.length;b++){var g=d[b].split(/\s*\:\s*/);e[g[0]]=g[1]}}c={color:c.color,fontFamily:c.fontFamily.split(/\s*,\s*/)[0].replace(/(^"|^'|'$|"$)/g,"").toLowerCase(),fontSize:this.pixelsFromCssAmount(c.fontSize,12,a.parentNode),fontWeight:this.cssFontWeightMap[c.fontWeight],
fontStyle:c.fontStyle?c.fontStyle:"normal",fontStretchPercent:this.cssFontStretchMap[e&&e["font-stretch"]?e["font-stretch"]:"default"],textDecoration:c.textDecoration,lineHeight:this.pixelsFromCssAmount(c.lineHeight,"normal",a.parentNode),letterSpacing:this.pixelsFromCssAmount(c.letterSpacing,0,a.parentNode),textTransform:c.textTransform};var f;this.faces[c.fontFamily]&&this.faces[c.fontFamily][c.fontWeight]&&(f=this.faces[c.fontFamily][c.fontWeight][c.fontStyle]);b=a.nodeValue;b=a.previousSibling&&
a.previousSibling.nodeType==1&&a.previousSibling.tagName!="BR"&&this.getElementStyle(a.previousSibling).display.match(/inline/)?b.replace(/^\s+/," "):b.replace(/^\s+/,"");b=a.nextSibling&&a.nextSibling.nodeType==1&&a.nextSibling.tagName!="BR"&&this.getElementStyle(a.nextSibling).display.match(/inline/)?b.replace(/\s+$/," "):b.replace(/\s+$/,"");b=b.replace(/\s+/g," ");if(c.textTransform&&c.textTransform!="none")switch(c.textTransform){case "capitalize":b=this.capitalizeText(b);break;case "uppercase":b=
b.toUpperCase();break;case "lowercase":b=b.toLowerCase()}if(f){a=b.split(/\b(?=\w)/);e=document.createElement("span");e.className="typeface-js-vector-container";d=a.length;for(b=0;b<d;b++){var h=a[b];if(g=this.renderWord(f,c,h))if(e.appendChild(g.element),!this.disableSelection){var i=document.createElement("span");i.className="typeface-js-selected-text";h=document.createTextNode(h);i.appendChild(h);if(this.vectorBackend!="vml")i.style.marginLeft=-1*(g.width+1)+"px";i.targetWidth=g.width;this.vectorBackend==
"vml"?g.element.appendChild(i):e.appendChild(i)}}return e}else f=b.substring(0,12),b.length>12&&(f+="..."),b=c.fontFamily,c.fontWeight!="normal"&&(b+=" "+c.fontWeight),c.fontStyle!="normal"&&(b+=" "+c.fontStyle),this.log("couldn't find typeface font: "+b+' for text "'+f+'"')},renderDocument:function(a){a||(a=function(a){a.style.visibility="visible"});for(var c=document.getElementsByTagName("*"),b=0;b<c.length;b++)if(c[b].className.match(/(^|\s)typeface-js(\s|$)/)||c[b].tagName.match(/^(H1|H2)$/))this.replaceText(c[b]),
typeof a=="function"&&a(c[b]);if(this.vectorBackend=="vml")a=document.createElement("v:shape"),a.style.display="none",document.body.appendChild(a)},replaceText:function(a){for(var c=a.childNodes.length,b=0;b<c;b++)this.replaceText(a.childNodes[b]);if(a.nodeType==3&&a.nodeValue.match(/\S/)&&(c=a.parentNode,c.className!="typeface-js-selected-text")){var d=this.getRenderedText(a);if(c.tagName=="A"&&this.vectorBackend=="vml"&&this.getElementStyle(c).display=="inline")c.style.display="inline-block",c.style.cursor=
"pointer";if(this.getElementStyle(c).display=="inline")c.style.display="inline-block";if(d){c.replaceChild?c.replaceChild(d,a):(c.insertBefore(d,a),c.removeChild(a));if(this.vectorBackend=="vml")d.innerHTML=d.innerHTML;for(c=d.childNodes.length;b<c;b++)if(a=d.childNodes[b],a.hasChildNodes()&&!a.targetWidth&&(a=a.childNodes[0]),a&&a.targetWidth){var e=(a.targetWidth-a.offsetWidth)/(a.innerHTML.length||1);this.vectorBackend=="vml"&&(e=Math.ceil(e));a.style.letterSpacing=e+"px";a.style.width=a.targetWidth+
"px"}}}},applyElementVerticalMetrics:function(a,c,b){if(c.lineHeight=="normal")c.lineHeight=this.pixelsFromPoints(a,c,a.lineHeight);a=c.lineHeight-this.pixelsFromPoints(a,c,a.lineHeight);b.style.marginTop=Math.round(a/2)+"px";b.style.marginBottom=Math.round(a/2)+"px"},vectorBackends:{canvas:{_initializeSurface:function(a,c,b){var d=this.getTextExtents(a,c,b),e=document.createElement("canvas");if(this.disableSelection)e.innerHTML=b;e.height=Math.round(this.pixelsFromPoints(a,c,a.lineHeight));e.width=
Math.round(this.pixelsFromPoints(a,c,d.x,"horizontal"));this.applyElementVerticalMetrics(a,c,e);if(d.x>d.ha)e.style.marginRight=Math.round(this.pixelsFromPoints(a,c,d.x-d.ha,"horizontal"))+"px";b=e.getContext("2d");d=this.pixelsFromPoints(a,c,1);b.scale(d*c.fontStretchPercent,-1*d);b.translate(0,-1*a.ascender);b.fillStyle=c.color;return{context:b,canvas:e}},_renderGlyph:function(a,c,b,d){b=c.glyphs[b];if(!b)return this.renderGlyph(a,c,this.fallbackCharacter,d);if(b.o){var e;b.cached_outline?e=b.cached_outline:
(e=b.o.split(" "),b.cached_outline=e);for(var g=e.length,f=0;f<g;)switch(e[f++]){case "m":a.moveTo(e[f++],e[f++]);break;case "l":a.lineTo(e[f++],e[f++]);break;case "q":var h=e[f++],i=e[f++];a.quadraticCurveTo(e[f++],e[f++],h,i);break;case "b":h=e[f++],i=e[f++],a.bezierCurveTo(e[f++],e[f++],e[f++],e[f++],h,i)}}b.ha&&(c=d.letterSpacing&&d.letterSpacing!="normal"?this.pointsFromPixels(c,d,d.letterSpacing):0,a.translate(b.ha+c,0))},_renderWord:function(a,c,b){var d=this.initializeSurface(a,c,b),e=d.context;
d=d.canvas;e.beginPath();e.save();b=b.split("");for(var g=b.length,f=0;f<g;f++)this.renderGlyph(e,a,b[f],c);e.fill();if(c.textDecoration=="underline")e.beginPath(),e.moveTo(0,a.underlinePosition),e.restore(),e.lineTo(0,a.underlinePosition),e.strokeStyle=c.color,e.lineWidth=a.underlineThickness,e.stroke();return{element:e.canvas,width:Math.floor(d.width)}}},vml:{_initializeSurface:function(a,c,b){var d=document.createElement("v:shape");b=this.getTextExtents(a,c,b);d.style.width=d.style.height=c.fontSize+
"px";d.style.marginLeft="-1px";if(b.x>b.ha)d.style.marginRight=this.pixelsFromPoints(a,c,b.x-b.ha,"horizontal")+"px";this.applyElementVerticalMetrics(a,c,d);b=a.resolution*100/72;d.coordsize=b/c.fontStretchPercent+","+b;d.coordorigin="0,"+a.ascender;d.style.flip="y";d.fillColor=c.color;d.stroked=!1;d.path="hh m 0,"+a.ascender+" l 0,"+a.descender+" ";return d},_renderGlyph:function(a,c,b,d,e,g){var f=c.glyphs[b];if(f){g.push("m");if(f.o){if(f.cached_outline)a=f.cached_outline,c=a.length;else{a=f.o.split(" ");
c=a.length;for(b=0;b<c;)switch(a[b++]){case "q":a[b]=Math.round(a[b++]),a[b]=Math.round(a[b++]);case "m":case "l":a[b]=Math.round(a[b++]),a[b]=Math.round(a[b++])}f.cached_outline=a}var h,i;for(b=0;b<c;){var j=a[b++];f=Math.round(a[b++])+d;e=Math.round(a[b++]);switch(j){case "m":g.push("xm ",f,",",e);break;case "l":g.push("l ",f,",",e);break;case "q":j=a[b++]+d;var k=a[b++];j=Math.round(h+2/3*(j-h));k=Math.round(i+2/3*(k-i));h=Math.round(j+(f-h)/3);i=Math.round(k+(e-i)/3);g.push("c ",j,",",k,",",h,
",",i,",",f,",",e);break;case "b":j=Math.round(a[b++])+d,k=a[b++],h=Math.round(a[b++])+d,i=a[b++],g.push("c ",j,",",k,",",h,",",i,",",f,",",e)}h=f;i=e}}g.push("x e");return g}else this.log("glyph not defined: "+b),this.renderGlyph(a,c,this.fallbackCharacter,d,e)},_renderWord:function(a,c,b){var d=0,e=this.initializeSurface(a,c,b),g=c.letterSpacing&&c.letterSpacing!="normal"?this.pointsFromPixels(a,c,c.letterSpacing):0;g=Math.round(g);var f=b.split("");b=[];for(var h=0;h<f.length;h++){var i=f[h];b=
this.renderGlyph(e,a,i,d,c,b);d+=a.glyphs[i].ha+g}c.textDecoration=="underline"&&(g=a.underlinePosition-a.underlineThickness/2,b.push("xm ",0,",",g),b.push("l ",d,",",g),b.push("l ",d,",",g+a.underlineThickness),b.push("l ",0,",",g+a.underlineThickness),b.push("l ",0,",",g),b.push("x e"));e.path+=b.join("")+"m "+d+" 0 l "+d+" "+a.ascender;return{element:e,width:Math.floor(this.pixelsFromPoints(a,c,d,"horizontal"))}}}},setVectorBackend:function(a){this.vectorBackend=a;for(var c=["renderWord","initializeSurface",
"renderGlyph"],b=0;b<c.length;b++){var d=c[b];this[d]=this.vectorBackends[a]["_"+d]}},initialize:function(){if(!arguments.callee.done)arguments.callee.done=!0,window._typefaceTimer&&clearInterval(n),this.renderDocument(function(a){a.style.visibility="visible"})}},k=[".typeface-js","h1","h2"];if(document.createStyleSheet){for(var j=document.createStyleSheet(),m=0;m<k.length;m++)j.addRule(k[m],"visibility: hidden");j.addRule(".typeface-js-selected-text",'-ms-filter: "Chroma(color=black) progid:DXImageTransform.Microsoft.MaskFilter(Color=white) progid:DXImageTransform.Microsoft.MaskFilter(Color=blue) alpha(opacity=30)" !important; color: black; font-family: Modern; position: absolute; white-space: pre; filter: alpha(opacity=0) !important;');
j.addRule(".typeface-js-vector-container","position: relative")}else if(document.styleSheets){document.styleSheets.length||function(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a)}();j=document.styleSheets[0];document.styleSheets[0].insertRule(k.join(",")+" { visibility: hidden; }",j.cssRules.length);document.styleSheets[0].insertRule(".typeface-js-selected-text { color: rgba(128, 128, 128, 0); opacity: 0.30; position: absolute; font-family: Arial, sans-serif; white-space: pre }",
j.cssRules.length);try{document.styleSheets[0].insertRule(".typeface-js-selected-text::-moz-selection { background: blue; }",j.cssRules.length)}catch(o){}try{document.styleSheets[0].insertRule(".typeface-js-selected-text::selection { background: blue; }",j.cssRules.length)}catch(p){}/WebKit/i.test(navigator.userAgent)&&document.styleSheets[0].insertRule(".typeface-js-vector-container { position: relative }",j.cssRules.length)}k=window.CanvasRenderingContext2D||document.createElement("canvas").getContext?
"canvas":window.attachEvent&&!window.opera?"vml":null;k=="vml"&&(document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),j=document.createStyleSheet(),j.addRule("v\\:shape","display: inline-block;"));l.setVectorBackend(k);window._typeface_js=l;if(/WebKit/i.test(navigator.userAgent))var n=setInterval(function(){/loaded|complete/.test(document.readyState)&&l.initialize()},10);document.addEventListener&&window.addEventListener("DOMContentLoaded",function(){l.initialize()},!1);try{console.log("initializing typeface.js")}catch(q){}})();